%% File: supplement.tex

\appendix

\onecolumn

\begin{center}
\fbox{\textbf{Supplementary Material}}
\end{center}

\bigskip

\noindent
\underline{Paper title:}~
Synchronous Dynamical Systems on Directed Acyclic Graphs (DAGs): 
Complexity and Algorithms

\bigskip

%% Section 3

\noindent
\section{Proofs of the Results in Section~\ref{sec:bounded-levels}}

\medskip

\iffalse
%%%%%%%%%%%%%%%%%%%%%%%%%%%
\noindent
\textbf{Statement and Proof of Proposition~\ref{pro:long_phase_space_cycle}}

\medskip

\underline{Statement of Proposition~\ref{pro:long_phase_space_cycle}:}~
For every $n  > 1$, there is an $n$ node DAG SyDS
whose phase space graph is a cycle of length $2^n$.

\medskip

\noindent
\textbf{Proof:}~
For a given $n > 1$ we construct the DAG SyDS $S_n$ to be a counter,
as follows.  The underlying graph contains $n$ levels, one node per
level.  For each node, there is an incoming edge from the nodes on
each of the lower levels.  The transition function for each node
is the function that retains the current value of the node if any
of the lower order bits is 0, and changes the value of the node if
all of the lower order bits are 1.

Suppose a given configuration of $S_n$ is interpreted as encoding
an integer $k$, $0 \leq k < 2^n$.  Then the successor configuration
encodes the integer $k + 1 \mod 2^n$.  Thus, the phase space of
$S_n$ is a cycle of length $2^n$.  \QED
%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fi


\noindent
\textbf{Statement and Proof of Lemma~\ref{lem:all_inputs_stable}}

\medskip

\noindent
\underline{Statement of Lemma~\ref{lem:all_inputs_stable}:}~
For a given DAG SyDS, and a given initial configuration, suppose
that the node values of all incoming edges to a given node $v$ are
stable at time $t$.  Then node $v$ is either alternating at time
$t$, or stable at time $t+1$.

\medskip

\noindent
\textbf{Proof:}~
Given the stable value of each incoming variable, the local transition
function for node $v$ at any time $t'$, where $t' \geq t$ is a
function of only one variable: the self variable $v$.  The only
possible functions of a single variable are a constant function,
the identity function, or the complement function.  If the local
transition function for $v$ is a constant function, then the value
of $v$ can possibly change between $t$ and $t+1$, but for any $t'
\geq t+1$, remains unchanged.  If the local transition function for
$v$ is the identity function, then the value of $v$ never changes
from its value at time $t$.  If the local transition function for
$v$ is the complement function, then the value of $v$ alternates
between complementary values.  \QED

\medskip

\noindent
\textbf{Statement and Proof of Theorem~\ref{thm:levels_phase_space}}

\medskip

\noindent
\underline{Statement of Theorem~\ref{thm:levels_phase_space}:}~
For a DAG SyDS,
the length of every phase space cycle is a power of 2.
Moreover if the number of levels of a given acyclic SyDS is $L$,
then no phase space cycle is longer than $2^L$,
and no transient is longer than $2^L-1$.

\medskip

\noindent
\textbf{Proof:}~ We use induction on the number of levels.

\smallskip

\noindent
{\bf Basis}: Suppose that there is only one level.
Then the underlying  graph has no edges.
By Lemma \ref{lem:all_inputs_stable},
either all phase cycles are of length 1 or all are of length 2. 
Also, no transient is of length greater than 1.

\smallskip

\noindent
{\bf Induction Step}: Suppose that the result holds for a given value of $L$,
and consider a DAG SyDS \cals{} with $L+1$ levels (numbered as levels 0 through $L$).
Let $\cals_L$ be the DAG SyDS with $L$ levels obtained 
by deleting $\call_L$ (the nodes in level $L$) from \cals{}.
Let \calc{} be a given configuration of \cals{}.

\smallskip

For non-negative integer $i$, 
recall that $C_i$ denotes the configuration of \cals{} at time $i$, 
when started from configuration \calc{}.
Since the underlying graph in $S$ has 
no edges from the level $L$ nodes to the nodes in $\cals_L$,
$C_i[\call_{L-1}']$ is the configuration at time $i$ 
when $S_L$ starts in configuration $C_0[\call_{L-1}']$.

From the induction hypothesis, when $\cals_L$  is started in
configuration $C_0[\call_{L-1}']$, the length of the phase space
cycle that is reached is $2^k$, where $0 \leq k \leq L$, and the
length of the transient leading to this cycle is some value $j$
such that $j \leq 2^L-1$.

Let $v$ be a level $L$ node of \cals{}.
The sequence of values taken on by $v$ 
can be classified as belonging to one of the following three cases.

\smallskip

\noindent
{\bf Case 1.} $C_{j+2^k}(v) = C_j(v)$:
Then, for every $i \geq j$, $C_{i+2^k}(v) = C_i(v)$.  Thus, the
values of $C_i(v)$, where $i \geq j$, form a cycle, whose period
divides (not necessarily properly) $2^k$.  So, after a transient
of length at most $j$, where $j \leq 2^L-1$, the value of node $v$
cycles with a cycle whose length is a power of 2 and is at most
$2^L$.

\smallskip

\noindent
{\bf Case 2}. $C_{j+2^k}(v) = \overline{C_j(v)}$ and $C_{j+2^{k+1}}(v) = C_j(v)$:
Then, for every $i \geq j$, $C_{i+2^{k+1}}(v) = C_i(v)$.
Thus, the values of $C_i(v)$, where $i \geq j$, form a cycle, 
whose period divides (not necessarily properly) $2^{k+1}$.
So, after a transient of length at most $2^L-1$,
the value of node $v$ cycles with a cycle whose length is 
a power of 2 and is at most $2^{L+1}$.

\smallskip

\noindent
{\bf Case 3}. $C_{j+2^k}(v) = \overline{C_j(v)}$ 
and $C_{j+2^{k+1}}(v) = \overline{C_j(v)}$:
Then, for every $i \geq j + 2^k$, $C_{i+2^k}(v) = C_i(v)$.
Thus, the values of $C_i(v)$, where $i \geq j + 2^k$, form a cycle, 
whose period divides (not necessarily properly) $2^k$.
Note that  $\calc_{j+2^k}$ is part of this cycle.
So, after a transient of length at most $2^{L+1}-1$,
the value of node $v$ cycles with a cycle whose length is 
a power of 2 and is at most $2^L$.


Considering all the nodes in \cals{}, the length of the transient
beginning at  \calc{} is at most $2^{k+1}-1$, and the length of the
cycle reached from  \calc{} divides $2^{k+1}$.

Since this holds for all configurations \calc{}, the inductive
hypothesis holds for \cals{}.  
\QED

\bigskip

\noindent
\textbf{Statement and Proof of Theorem~\ref{thm:path_length_lower_bounds}}

\medskip

\noindent
\underline{Statement of Theorem~\ref{thm:path_length_lower_bounds}:}
For every $L  \geq 1$,
there is a a DAG-SyDS with $L$ levels
whose phase space contains a transient of length $2^L-1$,
leading to a cycle of length $2^L$.

\medskip

\noindent
\textbf{Proof:}~ 
We show this by constructing a DAG SyDS that
incorporates the counter from Proposition \ref{pro:long_phase_space_cycle}
to produce a long cycle, and repeated applications of Case 3 from
the proof of Theorem \ref{thm:levels_phase_space} to produce a long
transient.

The constructed SyDS \cals{}  contains
$2L$ nodes, which we refer to as $X = \{x_0, x_1, \dots , x_{L-1}\}$ 
and $Y = \{y_0, y_1, \dots , y_{L-1}\}$.
For each $i$, nodes $x_i$ and $y_i$ will occur on level $i$.

The underlying graph of \cals{} has directed edges
$(x_i, x_j)$  and $(x_i, y_j)$ for each $i$ and $j$  such that $0 \leq i < j  < L$,
and also has directed edges $(y_i, y_{i+1})$ for each $i$ such that $0 \leq i < L-1$.

The local transition function for each node in $X$ is the function 
that retains the current value of the node if any of the incoming variables equals 0,
and changes the value of the node otherwise.
Thus, node set $X$ behaves as a counter,
similar to the nodes in the construction of 
Proposition \ref{pro:long_phase_space_cycle}.

The local transition function for node $y_0$ is the constant function
1.  The local transition function for each node $y_i$, $1 \leq i
\leq L-1$, is 1 iff $y_i = 1$ or $y_{i-1} = 1$ and the incoming
variables $\{x_0, x_1, \dots , x_{i-1}\}$ encode the integer $2^i-2$.

Note that the $L$ nodes in $X$ form a phase space cycle of length $2^L$.

Consider the initial configuration \calc{}, where all nodes have the value 0.
It can be seen that by induction on $i$, for each node $y_i$, $0 \leq i \leq L-1$,
and each nonnegative $j$, 
$\calc_j(y_i)$ equals 0 if $j < 2^{i+1} -1$, and equals 1 if $j \geq 2^{i+1} -1$.
Since $y_{L-1}$ does not change from 0 to 1 until configuration $C_{2^L-1}$, 
the length of the transient from \calc{} is $2^L-1$.
\QED

\bigskip

%% Section 4.

\section{Material for Section~\ref{sec:reachability}}
\label{asec:reach}

\medskip

\noindent
\textbf{Table mentioned in the Proof of Theorem~\ref{thm:reach-six-sym}:}

\medskip

In the proof of Theorem~\ref{thm:reach-six-sym}, we mentioned a table
to illustrates the dataflow as the constructed SyDS \cals{}  
for $n =4$ goes through its initial sequence of transitions.
This is shown as Table~\ref{tab:dag_syds_trans} above.

\bigskip

\begin{table*}
\begin{center}
\begin{tabular}{|l | c c c c c c c c c c c |} \hline
\multicolumn{12}{|c|}{{\bf Initial Configuration Sequence of 
Constructed SyDS for Four Variables}}\\ \hline

$C_i$ &$r_3$ & $r_2$ & $r_1$ & $r_0$ & $W$ & $h$ & $y_4$ & $y_3$ & $y_2$ & $y_1$ & $y_0$ \\ \hline
$\calc_0$ & 0 & 0 & 0 & 0 & $--0--$ & 0 & 0 & 0 & 0 & 0 & 0 \\ 
$\calc_1$ & 0 & 0 & 0 & 0 & $W(0000)$ & 0 & 0 & 0 & 0 & 0 & 1 \\ 
$\calc_2$ & 0 & 0 & 0 & $f(0000)$ & $W(0001)$ & 0 & 0 & 0 & 0 & 1 & 0 \\ 
$\calc_3$ & 0 & 0 & 0 & $F_0(000)$ & $W(0010)$ & 0 & 0 & 0 & 0 & 1 & 1 \\ 
$\calc_4$ & 0 & 0 & $F_0(000)$ & $f(0010)$ & $W(0011)$ & 0 & 0 & 0 & 1 & 0 & 0 \\ 
$\calc_5$ & 0 & 0 & $F_0(000)$ & $F_0(001)$ & $W(0100)$ & 0 & 0 & 0 & 1 & 0 & 1 \\ 
$\calc_6$ & 0 & 0 & $F_1(00)$ & $f(0100)$ & $W(0101)$ & 0 & 0 & 0 & 1 & 1 & 0 \\ 
$\calc_7$ & 0 & $F_1(00)$ &$F_1(00)$ & $F_0(010)$ & $W(0110)$ & 0 & 0 & 0 & 1 & 1 & 1 \\ 
$\calc_8$ & 0 & $F_1(00)$ & $F_0(010)$ & $f(0110)$ & $W(0111)$ & 0 & 0 & 1 & 0 & 0 & 0 \\ 
$\calc_9$ & 0 & $F_1(00)$ & $F_0(010)$ & $F_0(011)$ & $W(1000)$ & 0 & 0 & 1 & 0 & 0 & 1 \\ 
$\calc_{10}$ & 0 & $F_1(00)$ & $F_1(01)$ & $f(1000)$ & $W(1001)$ & 0 & 0 & 1 & 0 & 1 & 0 \\ 
$\calc_{11}$ & 0 & $F_2(0)$ & $F_1(01)$ & $F_0(100)$ & $W(1010)$ & 0 & 0 & 1 & 0 & 1 & 1 \\ 
$\calc_{12}$ & $F_2(0)$& $F_2(0)$ & $F_0(100)$ & $f(1010)$ & $W(1011)$ & 0 & 0 & 1 & 1 & 0 & 0 \\ 
$\calc_{13}$ & $F_2(0)$& $F_2(0)$ & $F_0(100)$ & $F_0(101)$ & $W(1100)$ & 0 & 0 & 1 & 1 & 0 & 1 \\ 
$\calc_{14}$ & $F_2(0)$ & $F_2(0)$ & $F_1(10)$ & $f(1100)$ & $W(1101)$ & 0 & 0 & 1 & 1 & 1 & 0 \\ 
$\calc_{15}$ & $F_2(0)$ & $F_1(10)$ & $F_1(10)$ & $F_0(110)$ & $W(1110)$ & 0 & 0 & 1 & 1 & 1 & 1 \\ 
$\calc_{16}$ & $F_2(0)$ & $F_1(10)$ & $F_0(110)$ & $f(1110)$ & $W(1111)$ & 0 & 1 & 0 & 0 & 0 & 0 \\ 
$\calc_{17}$ & $F_2(0)$ & $F_1(10)$ & $F_0(110)$ & $F_0(111)$ & $W(0000)$ & 0 & 1 & 0 & 0 & 0 & 1 \\ 
$\calc_{18}$ & $F_2(0)$ & $F_1(10)$ & $F_1(11)$ & $f(0000)$ & $W(0001)$ & 0 & 1 & 0 & 0 & 1 & 0 \\ 
$\calc_{19}$ & $F_2(0)$ & $F_2(1)$ & $F_1(11)$ & $F_0(000)$ & $W(0010)$ & 0 & 1 & 0 & 0 & 1 & 1 \\ 
$\calc_{20}$ & $F_3$ & $F_2(1)$ & $F_1(11)$ & $f(0010)$ & $W(0011)$ & 1 & 1 & 0 & 1 & 0 & 0 \\ 
$\calc_{21}$ & $F_3$ & 0 & 0 & 0 & $W(0100)$ & 1 & 1 & 0 & 1 & 0 & 1 \\ \hline
\end{tabular}
\end{center}
\caption{Table illustrating the data flow for $n = 4$ 
as the DAG-SyDS \cals{} goes through the initial sequence of transitions}
\label{tab:dag_syds_trans}
\end{table*}

\medskip

\noindent
\textbf{Statement and Proof of Theorem~\ref{thm:r_symmetric_directed}:}

\medskip

\noindent
\underline{Statement Theorem~\ref{thm:r_symmetric_directed}:}
For a fixed value of $r$, there is a polynomial time algorithm that
given a directed $r$-symmetric SyDSs $\cals = (G(V,E), \calf)$,
constructs a directed symmetric SyDSs $\cals' = (G'(V',E'), \calf')$
and an embedding $h$ of $\cals$ into $\cals'$.  Moreover, if  $G$
is acyclic, then so is $G'$.  

\medskip

\noindent
\textbf{Proof:}~ 
For a given node $v \in V$, 
suppose that local transition function $f_v$ contains $m^v$ classes.
Note that $1 \leq m^v \leq r$.
Let $\nu_0^v, \nu_1^v, \ldots ,\nu_{m^v-1}^v$ be these classes,
where $\nu_0^v$ is the class that contains self variable $v$.

We assume that function $f_v$  is represented 
as a $m^v$-dimensional table,
accompanied by a list of which nodes are in each class.
This table gives the value of $f_v$ for each tuple
of the form $j_0,  j_1, \ldots , j_{m^v -1}$,
where for each $i$, $0 \leq j_i \leq |\nu_i^v|$.

We construct $\cals'$ as follows.
Let $\Delta$ be the cardinality of the largest class in $\calf$.
Let $q =  \Delta + 1$.

Node set $V'$ and function $h$ are constructed as follows.
For each node $v \in V$,
node set $V'$ contains $q^{r-1}$ nodes, each of which is mapped into $v$ by $h$.

 Edge set $E'$ is constructed as follows.
For a given node $v' \in V'$,
suppose that $h(v') = v$.
Consider an incoming edge $(u,v) \in E$.
Suppose that $u \in \nu_i^v$.
Then $q^i$ nodes in $h^{-1}(u)$ are selected,
and an incoming edge to $v'$ from each of these nodes is added to $E'$.
Note that $v$  lies in class  $\nu_0^v$,
so no incoming edges are added from nodes in $h^{-1}(v) - \{v'\}$.
Thus, if $G$ is a DAG, then so is $G'$.

The set of symmetric local transition functions $\calf'$ is constructed as follows.
Consider a given node $v' \in V'$. Let $v = h(v')$.
Let $c_v = \sum_{i=0}^{m^v-1} q^i \, |\nu_i^v|$.
Note that the number of incoming edges into $v'$ is 
$c_v -1$.
Thus, the table specifying symmetric function $f_{v'}$
has an entry for each value $j$ such that $0 \leq j \leq c_v$.
Consider the entry for a given $j$.
For each $i$ such that $0 \leq i < m_v$,
we compute values $k_i$ and $j_i$ as follows.
We set $k_0 =j$, and then for $1 \leq i < m_v$,
set $k_i = \lfloor k_{i-1}/q \rfloor$.
Then, for $0 \leq i < m_v$, set $j_i = k_i \mod q$.
If each $j_i$ satisfies the requirement that $j_i \leq | \nu_i^v |$,
we let $\hat{j}$ be the $m^v$-tuple $j_0,  j_1, \ldots , j_{m^v -1}$,
and set the table entry for $j$ in $f_{v'}$ equal to the entry for $\hat{j}$ 
 in the table for $f_v$.
Otherwise we set the table entry for $i$ in $f_{v'}$ equal to an arbitrary value.
Note that all nodes $v'$ such that $h(v')=v$ have the same table.

Since $r$ is fixed, the above construction can be done in polynomial time.

We now argue that $h$ is indeed an embedding of $\cals$ into $\cals'$.
Consider a given configuration $\calc$ of $\cals$.
Let $\cald$  be the configuration such that $\calc \longrightarrow \cald$.
Let $\calc' =\hat{h}(\calc)$, 
and let $\cald$  be the configuration such that $\calc' \longrightarrow \cald'$.

Consider a given node $v' \in V'$.
Suppose that $h(v') = v$.
Suppose that for $0 \leq i < m^v$,
class $\nu_i^v$ contains $j_i$ generalized neighbors of $v$ that are 1 in $\calc$.
Then $\cald(v) = f_v(j_0,  j_1, \ldots , j_{m^v -1})$.
Consider a given class $\nu_i^v$ of $f_v$.
Let $u$ be a generalized neighbor of $v$ such that $ u \in \nu_i^v$.
Then node $v'$ has $q^i$ generalized neighbors $u'$ such that $h(u') = u$.
Since $\calc' =\hat{h}(\calc)$, for each of these $q^i$ nodes $u'$,
$\calc'(u') = \calc(u)$.
Since the number of generalized neighbors of $v$ from class $\nu_i^v$ 
with value 1 in $\calc$ is $j_i$,
the number of generalized neighbors of $v'$ 
that map into members of $\nu_i^v$ under $h$ and have value 1 in $\calc'$ is $q^i j_i$.
Considering all the classes of $f_v$,
the number of generalized neighbors of $v'$ that have value 1 in $\calc'$ is 
$j = \sum_{i=0}^{m^v-1} q^i \, j_i$.
But, by the construction of $\cals'$,
$f_{v'}(j) = f_v(j_0,  j_1, \ldots , j_{m^v -1})$.
Thus, $\cald'(v') = \cald(v)$.

Since the above applies to every node $v' \in V'$,  $\cald' =\hat{h}(\cald)$.
Thus, $h$ is an embedding of $\cals$ into $\cals'$.
\QED

\bigskip

%% Section 5.

\section{Proof of a Result in Section~\ref{sec:conv_guarantee}}

\medskip

\noindent
\textbf{Statement and Proof of Theorem~\ref{thm:convergence_guaranee}:}

\medskip

\noindent
\underline{Statement of Theorem~\ref{thm:convergence_guaranee}:}
The convergence guarantee problem for DAG SyDSs is co-NP-complete,
even when restricted to dags with three levels and 3-symmetric functions.

\medskip

\noindent
\textbf{Proof:}~ The problem is in \cconp{} since when the answer to the
convergence guarantee is ``NO", one can guess a specific initial configuration,
run the DAG SyDS for a number of steps equal to the number of levels, and
thus demonstrate efficiently that the system has not reached a fixed point.
To prove \cnp-hardness, we use a reduction from 3SAT.

Given an instance of 3SAT,
the constructed DAG-SyDS $\cals$ has a level zero node for each variable, 
a level one node for each clause, and a single node at level two.
We denote these three sets of nodes as $\{x_1, x_2, \ldots , x_n\}$,
$\{c_1,c_2, \ldots , c_m\}$, and $\{y\}$, respectively.

There is a directed edge from a  level zero node for a given variable
to each of  the nodes for the clauses involving that variable.
There is a directed edge from each level one node to node $y$.  The
local transition function for each level zero node is the identity
function.  The local transition function for each level one node
is the function that equals 1
if the value of at least one of the incoming edges
makes the clause true.  (This transition function is 3-symmetric
because at least two of the literals are positive or negative.) The
local transition function for $y$ is the function 
$\bar{y} \, \wedge \, c_1 c_2 \cdots  c_{m}$.

Note that for every initial configuration, the level zero nodes are
all stable at time 0, and the level one nodes are all stable at
time 1.

\smallskip

Suppose the given 3SAT instance is satisfiable.
Then any initial configuration of $\cals$ where the level zero nodes 
have values corresponding to a satisfying assignment
results in node $y$ being alternating at time 1.
Suppose the given 3SAT problem instance is unsatisfiable.
Then for every initial configuration, node $y$ is stable with value 0 at time 2.

\smallskip

Thus, $\cals$ reaches a fixed point from every initial configuration, 
i.e.,  convergence is guaranteed for $\cals$,
iff the given 3SAT problem instance is unsatisfiable.
The theorem follows.  \QED



\section{Proofs of Results in Section~\ref{sec:reach_special}}

\medskip

\noindent
\textbf{Statement and Proof of Theorem~\ref{thm:monotone_stable}:}

\medskip

\noindent
\underline{Statement of Theorem~\ref{thm:monotone_stable}:}~
For a DAG monotone SyDS, every cycle is a fixed point, 
and the length of any transient does not exceed the number of levels.

\medskip

\noindent
\textbf{Proof:}~ 
By induction on the number of levels for each level $i$, 
each level $i$ node is stable after at most $i$ steps.

From Lemma \ref{lem:level_zero_nodes}, every level 0 node is either
stable or alternating  at time 1.  The complement function is not
monotone, so a  level 0 node is cannot be alternating, and thus is
stable at time 1.

Suppose that all the incoming edges to a given node $v$ have stable
values at time $t$.  From Lemma \ref{lem:all_inputs_stable}, node
$v$ is either stable or alternating  at time $t+1$.  Since the local
transition function for node $v$ is monotone, and all the incoming
edges have stable values at time $t$, node $v$ is stable at time
$t+1$. \QED

\medskip

We note that that for every $L \geq 0$, there exists a DAG
monotone SyDS with a transient of length $L$.  Consider the SyDS
whose underlying graph is a directed chain of $L$ nodes.  The local
transition function of the level 0 node is the constant 1, and of
every other node is the {\em or} of its value and the value from
the incoming edge.  The configuration of all zeros takes $L$ steps
to reach the fixed point of all ones.


\subsection{Reachability Problem for DAG-SyDSs with Nested Canalyzing Local Functions}
\label{asec:reach_ncf}

\medskip

\subsubsection{Definition of Nested Canalyzing Functions}

\medskip

This class of Boolean functions 
was introduced in \cite{Kauffman-etal-2003} to carry out a detailed
analysis of the behavior of certain biological systems.
We follow the presentation in \cite{Layne-2011} in defining NCFs.
(For a Boolean value $b$,~ the complement is denoted by $\overline{b}$.)

\begin{definition}\label{def:nested_canalyzing}
Let $X = $ $\{x_1, x_2, \ldots, x_n\}$ denote a set of $n$  Boolean variables.
Let $\pi$ be a permutation of $\{1, 2, \ldots, n\}$.
A Boolean function $f(x_1, x_2, \ldots, x_n)$ over $X$ is \textbf{nested canalyzing}
in the variable order $x_{\pi(1)}, x_{\pi(2)}, \ldots, x_{\pi(n)}$ with
\textbf{canalyzing values} $a_1, a_2, \ldots, a_n$ and
\textbf{canalyzed values} $b_1, b_2, \ldots, b_n$
if $f$ can be expressed in the following form:

\medskip
\[
f(x_1, x_2, \ldots, x_n) ~=~ 
   \begin{cases}
       \:b_1 & \mathrm{if~~} x_{\pi(1)} ~=~ a_1 \\
       \:b_2 & \mathrm{if~~} x_{\pi(1)} ~\neq~ a_1 \mathrm{~~and~~}
            x_{\pi(2)} ~=~ a_2 \\
       \:\vdots & \vdots \\
       \:b_n & \mathrm{if~~} x_{\pi(1)} ~\neq~ a_1 \mathrm{~~and~~} \ldots~
             x_{\pi(n-1)} ~\neq~ a_{n-1} \mathrm{~~and~~} x_{\pi(n)} ~=~ a_n \\
       \:\overline{b_n} & \mathrm{if~~} x_{\pi(1)} ~\neq~ a_1 \mathrm{~~and~~} \ldots~
            x_{\pi(n)} ~\neq~ a_n \\
   \end{cases}
\]
\end{definition}

For convenience, we will use a notation introduced in \cite{Stearns-etal-2018}
to represent NCFs.
For $1 \leq i \leq n$, line $i$ of this representation has the form

\medskip

\noindent
\hspace*{1.1in} $x_{\pi(i)}:~ a_i ~~\longrightarrow~~ b_i$

\medskip

\noindent
with $x_{\pi(i)}$ being the \textbf{canalyzing variable} that is
\textbf{tested} in line $i$,
and $a_i$ and $b_i$ being respectively the canalyzing and
canalyzed values in line $i$,~ $1 \leq i \leq n$.
Each such line is called a \textbf{rule}.
When none of the conditions ``$x_{\pi(i)} ~=~ a_i$"
is satisfied, we have line $n+1$ with the ``Default" rule
for which the canalyzed value is~ $\overline{b_n}$:

\medskip

\noindent
\hspace*{1.1in} Default:~ $\overline{b_n}$

\medskip
\noindent
As in \cite{Stearns-etal-2018}, we will refer to the above specification
of an NCF as the \textbf{simplified representation} and assume
(without loss of generality) that each NCF is specified in this manner.

\medskip
\noindent
\textbf{Example:}~ Consider the function
$f(x_1, x_2, x_3) ~=~ x_1 \wedge (\overline{x_2} \vee x_3)$
used in Example~1.
This function is nested canalyzing using the identity permutation $\pi$ on $\{1,2,3\}$
with canalyzing values $0,0,1$ and canalyzed values $0, 1, 1$.
A simplified representation of this function is as follows.

\medskip

\noindent
\begin{tabular}{ll}
\hspace*{1.1in} & $x_1:~$  $0 ~\longrightarrow~ 0$ \\ [1ex]
\hspace*{1.1in} & $x_2:~$  $0 ~\longrightarrow~ 1$ \\ [1ex]
\hspace*{1.1in} & $x_3:~$  $1 ~\longrightarrow~ 1$ \\ [1ex]
\hspace*{1.1in} & Default:~ $0$ \\
\end{tabular}

\medskip

\noindent
We will also consider a more general form of NCFs defined in
\cite{Stearns-etal-2018}.

\begin{definition}\label{def:generalized ncf}
A {\bf generalized NCF} is a function represented as either a constant
or an NCF representation of a subset (not necessarily proper)
of the function's variables.
\end{definition}

\noindent
\textbf{Example:}~ Consider a Boolean function $f_1(x_1, x_2, x_3, x_4)$
whose generalized NCF representation is as follows.

\medskip

\noindent
\begin{tabular}{ll}
\hspace*{1.1in} & $x_2:~$  $1 ~\longrightarrow~ 0$ \\ [1ex]
\hspace*{1.1in} & $x_3:~$  $0 ~\longrightarrow~ 1$ \\ [1ex]
\hspace*{1.1in} & Default:~ $1$ \\
\end{tabular}

\smallskip

\noindent
This definition indicates that that the function $f_1$
depends only on the variables $x_2$ and $x_3$.

\medskip

\noindent
\subsubsection{Reachability Problem for DAG-SyDSs with NCF Local Functions}

\medskip

We are now ready to discuss our result for the Reachability problem
for DAG-SyDSs where each local function is a generalized NCF.
We begin with a lemma that points out a timing property of certain nodes.

\begin{lemma}\label{lem:ncf_plus_two}
Let \cals{} be a DAG-SyDS where each local function is a generalized-NCF.
For a given initial configuration,
let $v$ be a node such that the node values of all incoming edges to $v$
are  either stable or alternating at time $t$.
Then  $v$ is either stable or alternating at time $t+2$.
\end{lemma}

\medskip

\noindent
\textbf{Proof:}~ Let $g_v$ be the generalized-NCF obtained from
$f_v$ by replacing those variables corresponding to incoming edges
whose node values are stable at time $t$, with these stable values,
shortening and deleting lines from the representation of the NCF
as appropriate..  Note that $g_v$ determines the transitions of
node $v$ for all times $t'$ such that $t' \geq t$.

Let $V'$ be the set of nodes with incoming edges to $v$, such that
they are alternating at time $t$.  Let $\alpha$  be the assignment
of Boolean values to $V'$ where each node  is assigned its value
at time $t$.  Let $\overline{\alpha}$  be the assignment of Boolean
values to $V'$ where each node  is assigned the complement of its
value in $\alpha$.  Note that $\overline{\alpha}$ corresponds to
the values of the nodes in $V'$ at time $t+1$.

The proof proceeds by a case analysis of $g_v$.

\medskip

\noindent
\textbf{Case 1:}~ Suppose $g_v$ is a constant function.
Then node $v$ is stable at time $t+1$.

\medskip

\noindent
\textbf{Case 2:}~ Suppose $g_v$ contains at least one canalyzing variable, 
but $v$ is not a canalyzing variable of $g_v$.
If $g_v(\overline{\alpha}) = g_v(\alpha)$, then node $v$ is stable at time $t+1$.
and if $g_v(\overline{\alpha}) \neq g_v(\alpha)$, 
then node $v$ is alternating at time $t+1$.

\medskip

\noindent
\textbf{Case 3:}~ Suppose that $v$ is a canalyzing variable of
$g_v$, but not is not the canalyzing variable in the first line of
$g_v$.  We say that a given assignment to the nodes in $V'$ is {\bf
dominating} if in the assignment, at least one of the variables
occurring in a line prior to the line for $v$ in $g_v$ is equal to
its canalyzing value.  Since assignments $\alpha$  and $\overline{\alpha}$
are complementary, at least one of these assignments is dominating.
If assignment $\alpha$  is dominating, then $C_{t+1}(v)$ and
$C_{t+3}(v)$ are equal, so $v$ is either stable or alternating at
time $t+1$.  If assignment $\overline{\alpha}$  is dominating, then
$C_{t+2}(v)$ and $C_{t+4}(v)$ are equal, so $v$ is either stable
or alternating at time $t+2$.

\noindent \textbf{Case 4:}~ Suppose that the first line of $g_v$
has $v$ as the canalyzing variable.

\begin{description}
\item{\textsf{Case 4A:}}~ The first line of $g_v$ is the following, 
for some canalyzing value $a$:
%\medskip

\noindent
\hspace*{1.1in} $v:~ a ~~\longrightarrow~~ a$

\medskip

If $C_t(v)$ or $C_{t+2}(v)$ equals $a$, then node $v$ is stable
with value $a$ at time $t+2$.  If  $C_t(v)$  and $C_{t+2}(v)$ both
equal $\overline{a}$, then $C_{t+1}(v)$ also equals $\overline{a}$,
and $v$ is stable with value $\overline{a}$ at time $t$.

\item{\textsf{Case 4B:}}~ The first line of $g_v$ is the following,
for some canalyzing value $a$:

\noindent
\hspace*{1.1in} $v:~ a ~~\longrightarrow~~ \overline{a}$

%\medskip

\begin{description}
\item{\textsf{Case 4B1:}}~ Suppose $C_t(v) = a$. 
Then $C_{t+1}(v) =  \overline{a}$. 
If $C_{t+2}(v) = a$, then node $v$ is alternating at time $t$.
So, suppose that $C_{t+2}(v) = \overline{a}$.
If $C_{t+3}(v) = \overline{a}$,
then node $v$ is stable with value $\overline{a}$ at time $t+1$.
If $C_{t+3}(v) = a$, then $C_{t+4}(v) = \overline{a}$,
so node $v$ is alternating at time $t+2$.

\item{\textsf{Case 4B2:}}~ Suppose $C_t(v) = \overline{a}$.
If $C_{t+1}(v) = a$, then $C_{t+2}(v) = \overline{a}$,
and $v$ is alternating at time $t$.
If $C_{t+1}(v) = \overline{a}$ and $C_{t+2}(v) = a$, then node $v$ is alternating at time $t+1$.
If $C_{t+1}(v) = \overline{a}$ and $C_{t+2}(v) =  \overline{a}$, then node $v$ is stable at time $t$.
\end{description} % of Case4B
\end{description}

This completes all the cases and the lemma follows. \QED

\medskip

The above lemma enables us to prove bounds on the maximum
lengths of transients and cycles in the phase space of a DAG-SyDS
where each local function is a generalized NCF.

\medskip

\begin{theorem}\label{thm:NCF_phase_space}
For a DAG-SyDS \cals{} where each local function is a generalized NCF,
the length of every phase space cycle is at most 2.
Moreover if the number of levels of  \cals{} is $L$,
no transient is longer than $2L-1$.
\end{theorem}

\noindent
\textbf{Proof:}~ 
From Lemma \ref{lem:level_zero_nodes},
each level 0 node is either stable or alternating at $t=1$.

\medskip

From Lemma \ref{lem:ncf_plus_two},
for each subsequent level, each node at that level 
is either stable or alternating at most two steps after
all the nodes at lower levels have become stable or alternating.

\medskip

Since each node of  \cals{} eventually becomes either stable or alternating,
 the length of every phase space cycle is at most 2.
Moreover, a node at a given level $j$ becomes either stable alternating
after at most $2j-1$ steps.
Since  \cals{} contains $L$ levels,
any directed path leading to a fixed point or a cycle of length 2
can contain at most $2L-1$ configurations.
\QED

\medskip

Since Theorem~\ref{thm:NCF_phase_space} provides a polynomial bounds
on the lengths of transients and cycles in the phase space of any
DAG-SyDS whose local functions are generalized NCFs,
the following corollary is immediate.

\medskip

\begin{corollary}\label{cor:poly_ncf_dag_syds}
The Reachability problem is efficiently solvable for 
DAG-SyDSs where each local functions is a generalized NCF.
\end{corollary}
